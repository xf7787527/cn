# 颜色识别

## 一、接口描述

### 1. 功能描述

本API可以对输入图片的颜色分布进行分析，输出图片的N个关键颜色的色值（RGB和Hex）及其在图片中的占比。

### 2. 能力说明：

对图片的颜色分布进行分析，获得图片的关键颜色色值（RGB和Hex）以及各个颜色在图片中的占比。

### 3. 接口数据要求：

> 1. 图片格式：base64编码
> 2. 图片大小：不超过3.5MB
> 3. 图片类型：JPG(JPEG), BMP, PNG
> 4. 图片必须为RGB三通道

### 4. 接口使用：

进入京东智联云控制台-账号管理-Access Key管理，创建并获取Access Key。整体流程详见 [调用方法](https://docs.jdcloud.com/cn/common-declaration/api/call-methods) 。

## 二、请求说明

### 1. 接口地址 ：

```
https://aiapi.jdcloud.com/jdai/ai_extract_img_colors
```

### 2. 请求方式：

```
POST
```

### 3. 请求参数

#### （1）query请求参数

公共请求参数

| 名称      | 类型   | 必填 | 示例值                           | 描述                                           |
| --------- | ------ | ---- | -------------------------------- | ---------------------------------------------- |
| appkey    | string | 是   | 80d2b762ecb86593f9668526920f46c  | 您的appkey，可在买家中心控制台中获取           |
| timestamp | long   | 是   | 1541491668060                    | 请求的时间戳，精确到毫秒，timestamp有效期5分钟 |
| sign      | string | 是   | 2e148773a0337a8f2200ba90d445f083 | 签名，根据规则MD5(sectetkey+timestamp)，       |

#### （2）header请求参数

业务请求参数

| 名称         | 类型   | 必填 | 示例值                            | 描述                                      |
| ------------ | ------ | ---- | --------------------------------- | ----------------------------------------- |
| Content-Type | string | 是   | application/x-www-form-urlencoded | 标准编码格式，数据以名称=值的方式进行编码 |

#### （3）body请求参数

业务请求参数

| 名称        | 类型   | 必填 | 示例值                                                       | 描述                                                 |
| ----------- | ------ | ---- | ------------------------------------------------------------ | ---------------------------------------------------- |
| image       | string | 是   | 图像Base64编码值，去掉图片头"data:image/png;base64,"，content=/9j/4AAQSk...（由于过长，不给出示例） | 图像Base64编码                                       |
| color_count | int    | 否   | 10                                                           | 期望输出的颜色数量，默认为5， 最大值为10， 最小值为1 |

### 4、请求代码示例

建议您使用我们提供的SDK进行调用，SDK获取及调用方式详见本页一接口描述中的4接口使用

## 三、返回说明

### 1、返回参数

#### （1）公共返回参数

| 名称          | 类型    | 示例值        | 描述                                                         |
| ------------- | ------- | ------------- | ------------------------------------------------------------ |
| code          | string  | 1000          | 参见下方错误码-系统级错误码                                  |
| charge        | boolean | false 或 true | false：不扣费， true：扣费                                   |
| remainTimes   | long    | 1305          | 剩余调用次数；免费api：每天剩余调用次数；收费api：剩余次数；无限制时为-1 |
| remainSeconds | long    | 1223456       | 剩余调用时间（s）；免费api：-1；收费api：剩余调用时间；无限制时为-1 |
| msg           | string  | 查询成功      | 参见下方错误码-系统级错误码                                  |
| result        | object  | {...}         | 查询结果                                                     |

#### （2）业务返回参数

result参数信息

| 名称           | 类型   | 示例值                   | 描述                                 |
| -------------- | ------ | ------------------------ | ------------------------------------ |
| status_code    | int    | 0                        | 参照四、错误码-业务错误码            |
| status_message | string | "SUCCESS!"               | 参照四、错误码-业务错误信息          |
| color_list     | list   | [{...}, {...}..., {...}] | 颜色列表，按照各个颜色的占比进行排序 |

color_list中每个元素的参数信息

| 名称       | 类型   | 示例值      | 描述                                         |
| ---------- | ------ | ----------- | -------------------------------------------- |
| rgb        | string | 255,255,255 | 颜色的RGB值，英文逗号隔开，依次为R，G，B通道 |
| hex        | string | #FFFFFF     | 颜色Hex值，以"#"开头，其中的英文字符为大写   |
| percentage | float  | 0.7542      | 颜色占比                                     |

### 2、返回示例

```
Status Code: 200
Time：550ms
Date：Thu 8 Nov 2018 03:08:40 GMT
Body：
{
    "code": "0",
    "charge": false,
    "remain": 0,
    "msg": "查询成功",
    "result":  {
        "color_list": [
            {
                "rgb": "255,255,255",
                "hex": "#FFFFFF",
                "percentage": 0.7524
            },
            {
                "rgb": "0,0,0",
                "hex": "#000000",
                "percentage": 0.2476

            }
        ],
        "status_code": "0",
        "status_message": "success"
    }
}
```

## 四、错误码

### 1.系统级错误码

[详见返回码](https://aidoc.jd.com/user/returncode.html)

### 2.业务错误码

| 业务错误码（status） | 对应message                  | 说明                      |
| -------------------- | ---------------------------- | ------------------------- |
| 10001                | "no image content"           | 输入的参数中不包含image   |
| 10002                | "image base64 too large"     | 图像的base64大小超过限制  |
| 10003                | "unable to parse base64"     | 图像base64解析错误        |
| 10004                | "wrong image format"         | 错误的图像格式            |
| 10005                | "color count exceeded limit" | 输入的color_count参数越界 |