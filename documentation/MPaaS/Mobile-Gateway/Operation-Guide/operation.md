# 产品功能操作说明

## API规范管理

### API分类信息

点击左侧【API规范管理】菜单，右侧视图展示当前配置的规范列表；

选择规范列表行点击右侧的【分类信息】，查看当前规范下所有的API分类列表。当前列表中展示了分类关联的插件链及入关处理编解码器信息。

### API公共参数

在【API规范配置】页面，选择需要查看的规范，点击右侧【分类信息】，进入【API分类配置】页面，选择需要查看的API，点击右侧【公共参数】，进入【API公共参数配置】页面。该页面展示了API配置的请求及响应公共参数列表。公共参数的修改和删除，可以修改分类名称，域名编码，选择加解密算法，加验签算法，加解密算法和加验签算法都在元数据管理里设置，默认的插件链和入关处理类和访问方法。

## API管理

点击左侧菜单【API管理】，右侧视图显示已经创建的API开发分组；

点击要创建API的开发分组里的【查看API】，点击页面上方的【创建API】，点击某个规范的【配置API】，进入向导第一步。

### API导入导出

API导入：点击开发分组的【API上传】，选择需要导入的APIjson文件，选择导入的开发分组，URI命名空间、返回码命名空间，插件链，填写API名称和对外服务地址信息，查看出入关服务坐标信息，如不正确，可以修改，导入信息无误，点击导入按钮。 

API导出：在API列表页面点击【更多】->【导出】，导出的文件名格式为json。

### API编辑

在【API列表】页面选择需要修改的API，点击右侧【更多】->【编辑】按钮，进入【API接口编辑】页面，将【API名称】修改为期望的名字或者选择不同的插件链后，点击【保存】，即完成了API的编辑操作。

### API部署及下线

在【API列表】页面，选择需要部署的API，点击右侧的【部署】按钮。

在弹出框选择API部署的目标集群，点击确定；

已经部署的API右侧操作按钮会变成下线，点击【下线】按钮即可让API从当前集群下线，API状态更新为下线，且上一步的访问路径将不可用；

### 出入关映射

 API出入关映射概览，在【API列表】页面，选择一支API，点击右侧【更多】->【出入关映射】，可以看到该API下存在的映射关系。一支API可以存在多个映射关系，可以通过配置路由插件的路由策略来确定映射关系生效的条件。

 在API的【出入关映射列表页】点击【入关接口】，可以查看该条映射的入关参数配置，包含请求头，请求参数，响应头，响应参数的参数配置。

在API的【出入关映射列表页】点击【请求响应参数映射】，可以查看该条映射的请求参数和响应参数的入关接口配置和出关接口配置，修改请求参数的出关接口配置和响应参数的入关接口配置参数的引用位置。

在API的【出入关映射列表页】点击【出关接口】，可以查看该条映射的出关参数配置，包含请求上下文，请求参数，响应参数的配置，其中原生服务和超时时间可以修改，修改后，点击保存。

### API插件属性值配置

 API插件属性值的配置

1） 进入【API概览】，选择一个开发分组，点击【查看API】，进入【API列表】页面，选择一支API，点击API右侧的【高级功能】，进入API的插件链配置页面，点击插件链中的插件，可对该插件的属性值进行配置。

2） 点击【IP访问控制】插件，跳转至该插件的【API插件值管理】页面，对该插件的API粒度的属性值进行配置

3） 点击【新增】按钮，进行【IP访问控制】插件的插件值新增，页面中表格中出现一个空行，按照列名输入具体的配置参数，点击【保存】，则完成该条属性值的配置操作。点击【取消】，放弃该条记录的保存。

4） 对于已配置完成的插件值，如需进行修改或者删除，可点击右侧的【编辑】或者【删除】按钮，对本条记录进行修改或者删除。此处不再赘述

2、 用户API的插件属性值配置

1） 进入【API概览】，选择一个开发分组，点击【查看API】，进入【API列表】页面，选择一支API，点击API右侧的【高级功能】，进入API的插件链配置页面，如图下拉框中选择【用户API插件配置】，进入用户API插件配置页面。

2） 从【API用户配置】下拉框的右侧的下拉框中选择需要配置的用户信息，确定为哪个用户配置API插件属性值信息。

3） 确认用户信息后，点击对应的插件进行插件属性值配置，当前支持用户API插件属性值配置的插件只有两个【IP访问控制】和【流量控制】。仍以【IP访问控制】为例，进行用户API插件属性值的配置。

4） 点击【新增】按钮，表格中多一行空行，依据对应列的属性对数据进行编辑配置。配置完成后，点击【保存】，页面自动刷新，可以看到表格中新增了一条记录。

5） 对于已配置完成的插件值，如需进行修改或者删除，可点击右侧的【编辑】或者【删除】按钮，对本条记录进行修改或者删除。

## API分组管理

### 开发分组

点击界面左侧的【分组管理】-【开发分组】，右侧视图会展示当前所有的开发分组列表；

点击列表左上角【新建开发分组】按钮，如下图，按页面提示输入分组信息，点击提交，则成功添加了一条开发分组；添加成功会自动刷新当前列表，对于已新建完成的开发分组，可以进行修改和删除，点击右侧的【修改】或者【删除】。成员列表，点击【成员列表】->【添加】，通过组员的erp进行添加，可以对添加的组员进行删除，禁用，激活等操作。

### 产品分组

点击界面左侧的【分组管理】-【产品分组】，右侧视图会展示当前所有的产品分组列表；

点击列表左上角【新建产品分组】按钮，如下图，按页面提示输入分组信息，点击提交，则成功添加了一条产品分组；添加成功会自动刷新当前列表，如下图展示了添加的产品分组;

点击分组行右侧的【API管理】，跳转视图会显示当前产品分组下的所有API列表；

点击列表左上方的【添加API】，如下图按页面提示可以关联某开发分组下的API到当前产品分组； 

重复上步骤可以关联多个API到当前产品分组，提交成功页面自动刷新，如下图展示了当前产品分组下关联成功的API，对于添加的api可以进行禁用/激活/删除等操作。

点击分组行右侧的【修改】按钮可以修改当前分组；

点击分组行右侧的【删除】按钮可以删除当前分组；

## 公共资源

### 元数据管理

依次点击菜单【公共资源】-【元数据管理】，进入【元数据列表】页面，可以看到系统当前所有元数据信息。当前版本默认有一些基础元数据。在元数据管理中，可以添加元数据，管理元数据。

**添加元数据**

依次点击菜单【公共资源】-【元数据管理】，进入【元数据列表】页面，点击页面左上【添加元数据】按钮。

点击页面左上【添加元数据】按钮，进入【添加元数据】页面，为网关添加元数据。在该页面输入元数据名称、元数据值、元数据描述、元数据分组，点击【提交】，即可完成元数据的添加。

**修改元数据**

依次点击菜单【公共资源】-【元数据管理】，进入【元数据列表】页面，点击列表中对应元数据操作栏的修改链接。点击修改链接，进入【修改元数据】页面，修改元数据。在该页面修改元数据名称、元数据值、元数据描述、元数据分组，点击【提交】，即可完成元数据的修改。

**删除元数据**

依次点击菜单【公共资源】-【元数据管理】，进入【元数据列表】页面，点击列表中对应元数据操作栏的删除链接。点击删除链接，弹窗提示用户是否删除元数据，点击【确定】，即可完成元数据的删除。

### 返回码管理

依次点击菜单【公共资源】-【返回码管理】，进入【返回码列表】页面，可以看到系统当前所有返回码信息。可以添加返回码，管理返回码。

 **添加返回码**

依次点击菜单【公共资源】-【返回码管理】，进入【返回码列表】页面，点击页面左上【添加返回码映射】按钮。点击页面左上【添加返回码映射】按钮，进入【添加返回码配置】页面，为网关添加返回码配置。在该页面选择集合空间，输入内部返回码、内部返回码描述、外部返回码、外部返回码描述，点击【提交】，即可完成返回码的添加。

**修改返回码**

依次点击菜单【公共资源】-【返回码管理】，进入【返回码列表】页面，点击列表中对应返回码操作栏的修改链接。返回码详细信息修改，点击修改链接，进入【修改返回码】页面，修改返回码。在该页面修改内部返回码、内部返回码描述、外部返回码、外部返回码描述，点击【提交】，即可完成返回码的修改。

**删除返回码**

依次点击菜单【公共资源】-【返回码管理】，进入【返回码列表】页面，点击列表中对应返回码操作栏的删除链接。 点击删除链接，弹窗提示用户是否删除返回码，点击【确定】，即可完成返回码的删除。

### 命名空间管理

依次点击菜单【公共资源】-【命名空间】，进入【命名空间列表】页面，可以看到系统当前所有命名空间信息。可以添加命名空间，管理命名空间。

**添加命名空间**

依次点击菜单【公共资源】-【命名空间】，进入【命名空间列表】页面，点击页面左上【添加命名空间】按钮。

点击页面左上【添加命名空间】按钮，进入【添加命名空间】页面，为网关添加命名空间。在该页面输入命名空间编码、命名空间名称、命名空间描述，选择命名空间类型，点击【提交】，即可完成返回码的添加。

URI用与访问链接部分内容拼接，返回码，用于返回码前缀。

**命名空间授权管理**

依次点击菜单【公共资源】-【命名空间】，点击列表中对应命名空间操作栏的授权管理链接。 

进入【命名空间授权管理列表】页面，点击页面左上【+ 授权】按钮。

选择开发分组，点击【确认】按钮，即可完成命名空间授权。

**修改命名空间**

依次点击菜单【公共资源】-【命名空间】，进入【命名空间列表】页面，点击列表中对应命名空间操作栏的修改链接。点击修改链接，进入【修改命名空间】页面，修改命名空间。在该页面可修改命名空间名称，命名空间描述，点击【提交】，即可完成命名空间的修改。命名空间编码和命名空间类型不可修改

**删除命名空间**

依次点击菜单【公共资源】-【命名空间】，进入【命名空间列表】页面，点击列表中对应命名空间操作栏的删除链接。点击删除链接，弹窗提示用户是否删除命名空间，点击【确定】，即可完成命名的删除。

## 网关管理

依次点击菜单【网关管理】-【集群管理】，进入【集群列表】页面，可以看到系统当前所有集群信息。当前版本默认有一个处于激活状态的缺省集群。在集群管理中，可以为集群添加节点，管理集群部署的插件链，同时查看集群上运行的API信息。

**新建集群**

依次点击菜单【网关管理】-【集群管理】，进入【集群列表】页面，点击左上角的【新建集群按钮】，进入到【新建集群页面】，输入集群编码和集群名称，点击【提交】，创建集群。

**修改集群**

依次点击菜单【网关管理】-【集群管理】，进入【集群列表】页面，点击需要修改的集群的修改链接，修改集群名称，点击【提交】，修改集群名称。

**删除集群**

依次点击菜单【网关管理】-【集群管理】，进入【集群列表】页面，点击需要删除的集群的产出链接，在弹窗中点击【确认】，删除集群。

**节点管理**

集群节点列表展示: 在【集群列表】页面点击对应集群记录右侧的【节点管理】 ，进入集群的节点管理页面，可以看到集群所管理的节点列表。 

集群节点添加

点击页面左上【添加节点】按钮，进入【添加节点】页面，为集群添加节点。在该页面输入节点地址，此处的【节点地址】应为部署了网关服务的IP 地址，点击【提交】，即可完成节点信息的添加。

 集群节点监控

如果已部署完成的服务想要监控节点，可在【节点管理】中找到对应的IP地址，点击【节点监控】，即可完成跳转显示该节点的监控信息。

节点的删除

如果已部署完成的服务需要做下线操作，可在【节点管理】中找到对应的IP地址，点击【删除操作】，即完成节点的下线。

**插件链管理**

查看关联的插件链，依次点击【网关管理】-【集群管理】，选择对应的集群记录，点击右侧【插件链管理】，进入【插件链管理】页面，可以看到集群关联的插件链列表。

插件链部署

在【插件链管理】页面，点击左上角【插件链部署】按钮，选择插件链名称，点击【提交】即可将该插件链部署到对应的集群上。

插件链删除

在【插件链管理】页面，选择插件链名称对应的删除，在弹窗中点击【确定】即可将该插件链从对应的集群上删除

查看插件链的插件列表信息

在【插件链管理】页面中，选择需要查看的插件链，点击其右侧的【插件列表】按钮，查看当前插件链中所有的插件信息，包含插件顺序及插件名称。

**API部署列表**

 查看集群上部署的API信息

依次点击【网关管理】-【集群管理】，在集群列表中，选择需要查看的集群，点击右侧的【API部署列表】，进入【API部署列表】页面。

### 插件管理

依次点击【网关管理】-【插件管理】，进入插件列表在插件列表中。

**新建插件**

依次点击【网关管理】-【插件管理】，进入插件列表在插件列表中，点击左上角新建插件按钮，进入新建插件页，按照要求输入插件相关内容，点击【提交】按钮，创建插件。

**禁用及激活插件**

1）禁用插件

当前系统中默认所有插件都处于激活状态，当整个系统都不需要某个插件时，可以对该插件做【禁用】操作。选择对应插件，点击插件右侧的【禁用】按钮，对插件进行禁用操作。以【IP访问控制】插件为例，可以看到此时其【是否激活】状态变为了【否】。

2）激活插件

当被禁用的插件需要被系统使用时，需要执行激活操作。以【IP访问控制】插件为例，直接点击右侧【激活】按钮，即可将该插件变为【激活】状态。

**修改插件**

依次点击【网关管理】-【插件管理】，进入插件列表在插件列表中，点击需要修改的插件的修改链接，进入插件修改页，修改需要修改插件相关信息，点击【提交】按钮，修改插件内容。

**模板配置**

【模板】是插件运行所需数据结构的体现，不同插件所需的数据结构不同，模板配置也并不相同。此处仅以【IP访问控制】为例，对模板配置进行说明。

1） 点击【IP访问控制】右侧的【模板】，进入【插件模板管理】页面。

2） 点击【添加插件模板】，页面中表格会新增一行，在对应的列名下输入插件数据结构的具体信息，其中【健值】必须为网关代码中该插件的属性名称一致；【组件类型】固定值为【input】；【取值范围】和【默认值】需按照网关代码中属性实际情况填写；【标题】及【提示】可自行填写，容易记忆且能提到提示作用尤佳。

3） 数据填写完成后，点击【保存】则完成一条插件模板属性的配置，页面中可看到表格中出现一条配置完成的记录。点击【取消】则放弃本条记录的操操作。

4） 在配置完成一条插件模板属性后，可对配置完成的插件模板进行【编辑】和【移除操作】，点击【编辑】，可对已经配置好的数据进行修改。 

5） 点击【移除】，弹出【信息提示】对话框，提示是否确认要删除，点击【确定】删除本条记录，页面刷新，可看到记录被删除。如果点击【取消】，则记录保留。

**配置插件值**

此处配置的是该插件全局的插件值，影响范围是整个系统中使用到该插件的场景，故需要慎重配置。同样以【IP访问控制】插件为例。以下为操作步骤：

1） 依次进入【网关管理】-【插件管理】-【插件列表】菜单，在【IP访问控制】 插件的右侧选择【配置插件值】，进入【插件值管理】页面，可以看到页面中有一个四列组成的表格，其中前三列为上一小节【模板配置】中配置完成的模板属性。

2） 点击【新增】按钮，表格中会增加一行【空行】，在空的单元格中输入对应列的取值。如果不清楚每列的具体信息，将鼠标移至列名处，可看到该列属性对应的说明信息。

3） 点击【保存】完成该条记录的配置，页面自动刷新，可以看到表格中新增了一条记录。点击【取消】，放弃本条记录的编辑。

4） 如果需要对配置好的插件值进行【修改】或者【删除】操作，则在配置好的插件值的右侧，选择【编辑】或者【删除】按钮执行对应的编辑或者删除操作即可。

### 插件链管理

**插件链列表查看**

依次点击【网关管理】-【插件链管理】，进入【插件链列表】页面，查看当前系统所有插件链信息。 

**新建插件链**

依次点击【网关管理】-【插件链管理】，进入【插件链列表】页面，点击左上角【新建插件链】按钮，进入新建插件链页，输入插件链标识和插件链名称，点击【提交】按钮，完成插件链创建。

##### 插件链插件管理

**插件链查看**

在【插件链列表】页面，选择要查看的插件链，点击右侧【插件链编排】，可以查看到该插件链包含的插件列表信息以及插件链中插件的执行顺序。

**插件链添加插件**

点击插件链列表左上角【添加插件】按钮，页面新增一行，按照需求输入插件相关信息，点击【保存】，即可为插件链添加插件。

**插件链编辑插件**

点击插件链列表中需要修改的插件对应的【编辑】操作，按照需求修改插件，点击保存即可完成插件修改

**插件链插件移除**

点击插件链列表中需要修改的插件对应的【移除】操作，在弹窗中点击【确定按钮】，移除插件

**插件链配置插件值** 

页面跳转到插件管理，为插件配置插件值的插件值管理页

### 编解码器管理

**查看当前系统支持的【编解码器】**

依次点击【网关管理】-【编解码器】，可以看到当前系统的编解码器详情。其中绑定端口和协议分别指明了当前编解码器运行时监听的端口及支持的请求协议类型。

**部署编解码器**

依次点击【网关管理】-【编解码器】，点击部署编解码器，按照要求输入编解码器相关信息，点击保存，完成编解码器的部署

**修改编解码器**

依次点击【网关管理】-【编解码器】，点击需要修改的编解码器对应的【修改】，按照要求输入编解码器相关信息，点击提交，完成编解码器的修改，注意只有协议层编解码器名称和API识别表达式可以修改

**删除编解码器**

依次点击【网关管理】-【编解码器】，点击需要修改的编解码器对应的【删除】，在弹窗中点击【确定】，完成编解码器的删除

## 应用管理

**创建应用**

1、 点击左侧主菜单的【应用管理】，右侧则展现当前网关的所有应用信息，页面左上角点击【创建应用】，如图弹出的表单补全应用信息，点击【提交】；

应用的类型有三种，分别是Server，Native，H5，应用类型为Native或者H5时，如上图所示，当选择应用类型为Server时，显示用户类型和用户ID。

访问者类型主要有0:合作商户标识ID，1:客户ID，2:企业ID，3:账户ID，4:商户ID，5:商户号，6:二级商户ID，7:京东Pin，8:金融ID，9:合作商户会员ID，10:其他。访问者Code非必填。

2、 提交成功后，自动刷新列表，我们可以看到刚刚添加成功的应用信息

3、 点击应用列表的应用名称，可以查看应用的详细信息，点击返回，回到应用列表页。

**修改应用**

点击左侧主菜单的【应用管理】，右侧则展现当前网关的所有应用信息，点击需要修改的应用对应的修改操作，进入应用修改页面，修改需要修改的信息，点击【提交】，完成应用修改，其中应用类型不可修改。

**删除应用**

点击左侧主菜单的【应用管理】，右侧则展现当前网关的所有应用信息，点击需要删除的应用对应的删除操作，在弹窗中点击【确定】，完成应用删除

**Server**类型授权产品

点击Server类型应用行右侧的【已授权产品】，即可看到当前应用拥有的API分组权限列表，点击左上角的【产品授权】，即可在菜单按提示关联应用和分组绑定关系。

**产品授权页**

**已授权产品列表**

**解除授权**

选择想要解除授权的产品分组，点击右侧的【解除授权】，信息提示点击确定，该产品分组即从绑定关系页面删除。

**密钥管理**

点击某个应用右侧菜单的【密钥管理】，进入密钥管理页面，页面展现当前应用的所有密钥信息，页面左上角点击【添加密钥】，如图弹出的表单补全应用信息，点击【提交】；

**修改密钥**

点击需要修改的密钥对应的修改操作，进入密钥修改页面，修改需要修改的信息，点击【提交】，完成密钥修改，其中密钥类型不可修改。

**删除密钥**

点击需要删除的密钥对应的删除操作，在弹窗中点击【确定】，完成密钥删除

 

